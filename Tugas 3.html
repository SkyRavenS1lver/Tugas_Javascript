<!DOCTYPE html>
<html lang="en">

<head>
    <title>Kalkulator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <style type="text/css">
      button{padding: 10px;background-color: #54504C; color: wheat;}
      .tampilan{padding-left: 10px; padding-right: 10px; border: 10px solid black; text-align: right;}

    </style>
</head>

<body>
    <script>
      var nilai = "0";
      var operant = "";
      var temp = 0;
      var ends = false;
      var clicked = false;
      function add(number){
        clicked = true;
        if (ends){
          nilai = "0";
          operant = "";
          temp = 0;
          ends = false;
        }
        if (nilai == "0"){
          if (number == "."){nilai+=number;document.getElementById("nilai").innerHTML = nilai;clicked = false;}
          else if (number != "0"){nilai = number;document.getElementById("nilai").innerHTML = nilai}
          else{document.getElementById("nilai").innerHTML = "0"}
        }
        else if (nilai.includes(".") && number == '.'){}
        else{nilai+= number;}
        if(nilai.length >= 10){document.getElementById("nilai").innerHTML = "..."+nilai.substr(-10,10);}
        else{document.getElementById("nilai").innerHTML = nilai;}
      }
      function delete_numb(){
        if (ends){
          nilai = "0";
          operant = "";
          temp = 0;
          ends = false;
        }
        if (nilai.length >= 2){nilai = nilai.substr(0,nilai.length-1);}
        else if (nilai.length == 1){nilai = "0";clicked = false;}
        if(nilai.length >= 10){document.getElementById("nilai").innerHTML = "..."+nilai.substr(-10,10);}
        else{document.getElementById("nilai").innerHTML = nilai;}
      }

      function clear_numb(){
        clicked = false;
        if (ends){
          nilai = "0";
          operant = "";
          temp = 0;
          ends = false;
        }
        nilai = "0";
        document.getElementById("nilai").innerHTML = nilai;
        console.log(ends)
      }

      function operation(operasi){
        ends = false;
        
        if (clicked){clicked = false;
        if (operant == "" || operant == "+"){temp += parseFloat(nilai);}
          else {
            if (operant == "-"){
            temp -= parseFloat(nilai);}
          else if (operant == "x"){
            temp *= parseFloat(nilai);}
          else if (operant == "/"){
            temp /= parseFloat(nilai);} 
          else if (operant == "^"){
            temp = temp**parseInt(nilai);}
          }}
        operant = operasi;
        if(nilai.length >= 10){document.getElementById("temp").innerHTML =  (temp+"").substr(0,9)+"... "+operant;}
          else{document.getElementById("temp").innerHTML = temp+" "+operant}
        nilai = "0"
        document.getElementById("nilai").innerHTML = nilai;
      };

      function swapping(){
        ends = false;
        if (nilai != "0"){nilai = (parseFloat(nilai)*(-1))+""}
        document.getElementById("nilai").innerHTML = nilai;
      }

      function equals(){
        ends = false;
        if (operant == ""){document.getElementById("nilai").innerHTML = "ERROR"}
        else {
          if (operant == "+"){
          document.getElementById("temp").innerHTML = "";
          var hasil = parseFloat(nilai)+temp;
        }

        else if (operant == "-"){
          document.getElementById("temp").innerHTML = "";
          var hasil = temp-parseFloat(nilai);
        }

        else if (operant == "x"){
          document.getElementById("temp").innerHTML = "";
          var hasil = parseFloat(nilai)*temp;
        }

        else if (operant == "/"){
          document.getElementById("temp").innerHTML = "";
          var hasil = temp/parseFloat(nilai);
        }

        else if (operant == "^"){
          document.getElementById("temp").innerHTML = "";
          var hasil = temp**parseInt(nilai);
        }
        if (nilai.length >= 10){document.getElementById("nilai").innerHTML = (hasil+"").substr(0,5)+"...";}
        else{document.getElementById("nilai").innerHTML = hasil;}
        operant == ""
        ends = true;
      }}
    </script>
  <center>
  <table border="1" style="height: 100px; width: 100px; border: 10px solid black; padding-top: 100px; margin-top: 100px;">
    <tr>
      <td class="tampilan" colspan="5" style="padding-top: 5px; height: 90px; background-color: azure;">
        <sup id="temp"></sup>
        <p id="nilai">0</p>
      </td>
    </tr>
    <tr>
      <td><button onclick="add('7')">7</button></td>
      <td><button onclick="add('8')">8</button></td>
      <td><button onclick="add('9')">9</button></td>
      <td><button onclick="operation('+')" style="padding: 10px 8.5px;">+</button></td>
      <td><button onclick="delete_numb()" style="padding: 10px 3px 10px 3px;">Del</button></td>
    </tr>
    <tr>
      <td><button onclick="add('4')">4</button></td>
      <td><button onclick="add('5')">5</button></td>
      <td><button onclick="add('6')">6</button></td>
      <td><button onclick="operation('-')" style="padding-right: 11.5px;">-</button></td>
      <td><button onclick="clear_numb()" style="padding: 10px 9px 10px 10px;">C</button></td>
    </tr>
    <tr>
      <td><button onclick="add('1')">1</button></td>
      <td><button onclick="add('2')">2</button></td>
      <td><button onclick="add('3')">3</button></td>
      <td><button onclick="operation('x')">x</button></td>
      <td><button onclick="operation('^')" style="padding: 10px 9px 10px 9px;">^</button></td>
    </tr>
    <tr>
      <td><button onclick="swapping()" style="padding: 10px 3px 10px 3px;">+/-</button></td>
      <td><button onclick="add('0')">0</button></td>
      <td><button onclick="add('.')" style="padding-right: 15px;">.</button></td>
      <td><button onclick="operation('/')" style="padding-right: 11px;">/</button></td>
      <td><button onclick="equals()" style="padding-right: 8px;">=</button></td>
  </table>
  </center>
</body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
</html>